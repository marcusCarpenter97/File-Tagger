#include "../src/databaseManager.h"
#include <stdlib.h>

#define RET_VAL_OK EXIT_SUCCESS

const char* tag_name1 = "tag name 1";
const char* tag_name2 = "tag name 2";

const char* path_to_file_param1 = "/home/marcus/Documents/File Tagger/source/src/main.c";
const char* path_to_file_param2 = "/home/marcus/Documents/File Tagger/source/src/stateMachine.c";
const char* path_to_dir_param1 = "/home/marcus/Documents/File Tagger/source/src";
const char* path_to_dir_param2 = "/home/marcus/Documents/File Tagger/source/tests";

void setup(void) { //TODO does not work !!!
	initialize_database();
}

#test insert_one_tag_one_file
	initialize_database();
	append_path_to_sql_stmt(path_to_file_param1);
	append_tag_name_to_sql_stmt(tag_name1);
	int ret_val = insert_tags();
	fail_unless(ret_val == RET_VAL_OK);

#test insert_one_tag_many_files
	initialize_database();
	append_path_to_sql_stmt(path_to_file_param1);
	append_path_to_sql_stmt(path_to_dir_param1);
	append_tag_name_to_sql_stmt(tag_name1);
	int ret_val = insert_tags();
	fail_unless(ret_val == RET_VAL_OK);

#test insert_many_tags_one_file
	initialize_database();
	append_path_to_sql_stmt(path_to_file_param1);
	append_tag_name_to_sql_stmt(tag_name1);
	append_tag_name_to_sql_stmt(tag_name2);
	int ret_val = insert_tags();
	fail_unless(ret_val == RET_VAL_OK);

#test insert_many_tags_many_files
	initialize_database();
	append_path_to_sql_stmt(path_to_file_param1);
	append_path_to_sql_stmt(path_to_dir_param1);
	append_tag_name_to_sql_stmt(tag_name1);
	append_tag_name_to_sql_stmt(tag_name2);
	int ret_val = insert_tags();
	fail_unless(ret_val == RET_VAL_OK);

#test select_all_files_for_one_tag
	initialize_database();
	int ret_val = select_all_locations_for_tag(tag_name1);
	fail_unless(ret_val == RET_VAL_OK);
	
#test select_all_files_for_many_tags
	initialize_database();
	int ret_val = select_all_locations_for_tag(tag_name2);
	fail_unless(ret_val == RET_VAL_OK);

